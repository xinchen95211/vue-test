"use strict";(self["webpackChunkvuefront"]=self["webpackChunkvuefront"]||[]).push([[970],{5970:function(e,r,a){a.r(r),a.d(r,{default:function(){return f}});a(560);var l=a(6252);const t={class:"login-wrapper"},o=(0,l._)("br",null,null,-1),s={class:"msg"};function i(e,r,a,i,u,d){const m=(0,l.up)("retrieve-password-components");return(0,l.wg)(),(0,l.iD)("div",t,[(0,l.Wm)(m),o,(0,l._)("div",s,[(0,l.Uk)(" 已有账户? "),(0,l._)("a",{style:{color:"blue"},onClick:r[0]||(r[0]=e=>this.$router.push("/login"))},"去登陆")])])}var u=a(3577);const d=(0,l._)("div",{class:"header"},[(0,l._)("p",null,"找回密码")],-1);function m(e,r,a,t,o,s){const i=(0,l.up)("el-input"),m=(0,l.up)("el-form-item"),c=(0,l.up)("el-button"),n=(0,l.up)("el-form");return(0,l.wg)(),(0,l.iD)(l.HY,null,[d,(0,l.Wm)(n,{class:"form-wrapper",model:o.ruleForm,"status-icon":"",rules:o.rules,ref:"ruleForm","label-width":"auto"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{prop:"email",rules:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}]},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{type:"text",modelValue:o.ruleForm.email,"onUpdate:modelValue":r[0]||(r[0]=e=>o.ruleForm.email=e),placeholder:"邮箱",class:"input-item",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(m,{class:"input-item-row",prop:"emailCheckCode"},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{type:"text",modelValue:o.ruleForm.emailCheckCode,"onUpdate:modelValue":r[1]||(r[1]=e=>o.ruleForm.emailCheckCode=e),onkeyup:"value=value.replace(/\\D/g,'')",placeholder:"验证码",class:"input-item",clearable:""},null,8,["modelValue"]),(0,l.Wm)(c,{disabled:o.emailCheckCodeStatus,onClick:s.showEmailCheckCode},{default:(0,l.w5)((()=>[(0,l.Uk)((0,u.zw)(o.emailCheckCodeText),1)])),_:1},8,["disabled","onClick"])])),_:1}),(0,l.Wm)(m,{prop:"password"},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{type:"password",modelValue:o.ruleForm.password,"onUpdate:modelValue":r[2]||(r[2]=e=>o.ruleForm.password=e),placeholder:"新密码",class:"input-item",clearable:"","show-password":""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(m,{prop:"checkPassword"},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{type:"password",modelValue:o.ruleForm.checkPassword,"onUpdate:modelValue":r[3]||(r[3]=e=>o.ruleForm.checkPassword=e),placeholder:"确认密码",class:"input-item",clearable:"","show-password":""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"loginBtn",onClick:r[4]||(r[4]=e=>s.Retrieve("ruleForm"))},{default:(0,l.w5)((()=>[(0,l.Uk)("修改密码")])),_:1})])),_:1})])),_:1},8,["model","rules"])],64)}var c=a(5121),n=a(1348),p={name:"RetrievePasswordComponents",data(){const e=(e,r,a)=>{""===r?a(new Error("请输入密码")):r===this.ruleForm.password?a():a(new Error("两次密码输入不一致"))},r=(e,r,a)=>{""===r?a(new Error("请输入密码")):r.length<6?a(new Error("输入的密码太短了")):a()},a=async(e,r,a)=>{await this.checkEmail()?a(new Error("您还没有注册过呢")):a()},l=async(e,r,a)=>{""===r?a(new Error("请输入验证码")):(await this.checkEmailCode()?a():a(new Error("验证码输入错误")),a())};return{ruleForm:{username:"superstore",emailCheckCode:"",checkPassword:"",password:"",email:""},rules:{checkPassword:[{validator:e,trigger:"blur"}],password:[{validator:r,trigger:"blur"}],emailCheckCode:[{validator:l,trigger:"blur"}],email:[{validator:a,trigger:"blur"}]},emailCheckCodeText:"获取验证码",emailCheckCodeStatus:!1}},methods:{Retrieve(e){this.$refs[e].validate((e=>{if(!e)return!1;c.Z.post("/api/register/retrieve",this.ruleForm).then((e=>{211===e.data.code&&n.z8.success(e.data.message)}))}))},timer(e){e>0?(e--,this.emailCheckCodeText="已发送（"+e+"）",setTimeout((()=>{this.timer(e)}),1e3)):(this.emailCheckCodeText="获取验证码",this.emailCheckCodeStatus=!1)},showEmailCheckCode(){this.$refs.ruleForm.validateField("email",(e=>{if(!e)return!1;{this.emailCheckCodeStatus=!0;let e=60;this.timer(e),c.Z.get(`/api/register/getEmailCheckCode/${this.ruleForm.email}`).then((e=>{200===e.data.code&&n.z8.success(e.data.data)}))}}))},async checkEmail(){try{const e=await c.Z.get(`/api/register/checkEmail/${this.ruleForm.email}`);return 200===e.data.code}catch(e){return!1}},async checkEmailCode(){try{const e=await c.Z.post("/api/register/checkEmailCode",this.ruleForm);return 200===e.data.code}catch(e){return!1}}}},h=a(3744);const w=(0,h.Z)(p,[["render",m]]);var C=w,k={name:"RetrievePasswordView",components:{RetrievePasswordComponents:C}};const g=(0,h.Z)(k,[["render",i]]);var f=g}}]);
//# sourceMappingURL=970.3faa0893.js.map